---
title: "네트워크 계층 정리"
date: 2023-11-12 16:30:20 +0900
categories: [Study, Data Communication Network]
tags: [network]
---

### **개요**

인터넷의 정의

- 수백만 대의 컴퓨터를 연결하는 블랙박스 네트워크

- LAN과 WAN의 조합으로 연결된 네트워크

- 라우터나 케이블 등의 연결 장치를 통해 연결된 수많은 네트워크(또는 링크)로 구성됨

<br>

### **교환**

메시지를 발신지에서 목적지로 전달하는 과정에는 많은 결정이 이루어진다. 메시지가 연결 장치에 도착하면 패킷을 송신하는 출력 포트를 결정하는데, 이때 연결 장치는 한 포트를 다른 포트에 연결하는 교환기 역할을 한다.

**회선 교환**(circuit switching): 메시지 전달 전에 발신지와 목적지 사이에 물리 회선을 생성한 다음 메시지를 전달한다. 메시지 전달이 끝나면 네트워크에 통보하고, 다른 연결을 위해 연결을 해제한다. 물리 회선이 사라지는 것으로도 해석 가능.  
메시지가 전송되기 전에 발신지에서 목적지까지 물리적 통신 회선 연결이 선행되어야 하며 전체 경로가 미리 확보되어야 한다는 번거로움이 있다. 그러나 접속에는 긴 시간이 소요될지언정 물리 회선을 확보하기만 하면 라인을 독점 사용하므로 전송 지연은 거의 일어나지 않고 통신 속도가 매우 빠르다.

**패킷 교환**(packet switching): 상위층으로부터 받은 메시지를 패킷 단위로 분할하여 발신지에서 목적지까지 패킷 단위로 전달한다(회선 교환과 달리 패킷을 최종 목적지까지 전달한다).

오늘날 인터넷의 네트워크 계층은 패킷 교환망으로 설계되어 있으며, 데이터그램과 가상 회선을 사용한다.

<br>

### **네트워크 계층에서 패킷 교환**

<center>발신지에서 메시지는 데이터그램 단위로 분할</center>  
<center>▼</center>  
<center>각 데이터그램이 발신지에서 목적지로 전달</center>  
<center>▼</center>  
<center>수신된 데이터그램은 목적지에서 원래의 메시지로 재조립</center>

<br>

패킷 교환은 비연결형 서비스와 연결형 서비스를 지원한다. 비연결형(connectionless) 패킷 교환망은 각 패킷을 상호 독립적으로 처리하고, 네트워크 내 교환기 역할을 하는 라우터가 목적지 주소를 기반으로 패킷을 전달한다.

(left image) (right image)

연결형(connection-oriented) 패킷 교환망은 서비스 제공을 위해 연결 설정, 데이터 전송, 연결 해제 과정을 사용한다. 메시지에 속한 모든 패킷은 상호 관계성을 가진다. 우선, 데이터그램 송신 전 경로를 지정하는 가상 회선을 생성한다. 연결이 되면 전송 경로인 가상 회선을 따라 데이터그램이 전달되고, 이때 각 패킷에는 가상 회선 식별자(flow label)가 존재하여 해당 레이블을 기반으로 포워딩된다.

(image)

---

##### 📌 연결형 서비스 단계 자세히 알아보기

1. 연결 설정: 가상 회선을 위한 엔트리를 생성하는 단계. 요청 패킷은 발신지와 목적지 주소를 전달하고, 확인 응답 패킷은 라우팅 테이블 내의 엔트리를 완성하는 역할.

2. 데이터 전송: 엔트리를 기반으로 순서대로 전달

3. 연결 해제: 발신지는 패킷을 모두 보낸 후 연결 해제 패킷을 송신하고, 목적지는 확인응답 패킷으로 응답함. 이후 모든 라우터는 해당 엔트리를 삭제함.

---

<br>

가상 회선 망에서 패킷의 흐름은 다음과 같다.

1. A는 R1으로 요청 패킷을 전송
2. R1이 요청 패킷을 수신. R1은 이 가상 회선을 위해 테이블 내에 엔트리를 생성함(입력 포트, 입력 테이블, 출력 포트). 해당 패킷은 전송 경로를 따라 R1 →  R3 → R4 → B까지 흘러감.
3. B가 요청 패킷을 수신한 후, A부터 패킷을 수신할 준비가 되어 있으면 받은 패킷에 레이블을 할당함. 즉, 확인응답 패킷으로 응답함. 나갈 때는 들어올 때와 같은 경로인 B → R4 → R3 → R1 → A 순으로 흘러감.

(image)

<br>

### **네트워크 계층 서비스**

네트워크 계층은 비연결형 서비스를 기반으로 한다.

- 발신지 제공 서비스
  
  - 패킷화: 상위층인 전송 계층으로부터 온 데이터를 데이터그램으로 캡슐화
  
  - 다음 홉의 논리 주소(IP 주소) 찾기: 라우팅 테이블 참조
  
  - 다음 홉의 물리 주소(MAC) 찾기: ARP(Address Resolution Protocol) 사용
  
  - 데이터그램 단편화: 데이터그램이 MTU(Maximum Transmission Unit)보다 클 경우 수행

- 발신지 컴퓨터 제공 서비스
  
  - 다음 홉의 물리 주소를 찾기 위해 또 다른 테이블을 사용하여 다음 홉의 논리 주소를 물리 주소로 변환해야 함. 이때 ARP 사용

- 라우터 제공 서비스
  
  - 입출력의 인터페이스 관여
  - 다음 홉의 논리 주소 찾기
  - 다음 홉의 물리 주소 찾기
  - 데이터그램 단편화

- 목적지 컴퓨터 제공 서비스
  
  - 단편 재조립/유효성 검사
  
  - 상위층인 전송 계층에 전달
  
  - 재조립 타이머 설정: 딜레이를 카운트 하기 위한 장치로, 데이터그램 전달 완료 전에 타이머가 만료되면 재전송 오류 메시지를 전송함

<br>

##### ***용어 정리**

서버 컴퓨터: 네트워크 상의 컴퓨터. 터미널 종단에 위치함.

허브(hub): 네트워크 구성 요소들을 연결하는 가장 단순한 장치로, 네트워크에 연결된 다른 장치로 데이터 패킷을 보낼 수 있음. 즉, 모든 기기가 서로에 대해 라인을 가지고 있지 않으므로 중간에서 연결만 해주는 역할. 1계층.

스위치(switch): 네트워크 상의 특정 목적지로 데이터를 재전송하거나 필터링 기능을 수행함. 2계층.

라우터(router): 패킷 데이터를 다른 네트워크를 통해 정확한 주소로 전달하기 위해 사용하는 통신 프로세서. 라우팅 테이블에 따라 들어오는 데이터들의 헤더를 읽어서 길을 정해줌. 3계층.

<br>
