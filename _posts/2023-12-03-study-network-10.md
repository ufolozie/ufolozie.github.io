---
title: "[통신 및 네트워크] 네트워크 계층 작업과 프로토콜"
date: 2023-12-03 15:18:34 +0900
categories: [Study, Data Communication Network]
tags: [network]
---

> 데이터통신과 네트워킹, 조성호 저, 인피니티북스
> 
> > Chapter 12. 네트워크 계층 작업과 프로토콜

<br>

## **네트워크 분할**

### **서브넷 마스크 특징**

네트워크 계층의 작업은 네트워크를 여러 개의 서브넷으로 나누고, IP 주소와 MAC 주소를 변환하는 것이다. 4바이트로 이루어진 IP 주소는 빠르게 고갈되었고, 이러한 현상의 원인은 '누군가 하나의 클래스를 독점하면 해당 클래스의 IP가 남더라도 다른 사람이 사용할 수 없어 IP 주소가 낭비된다는 점'에 있다.

따라서 이러한 문제를 해결하기 위해 클래스를 여러 개로 나누어 사용하게 되었는데, 클래스를 자신의 규모에 맞는 서브넷으로 잘라서 사용하게 되었다. 이처럼 네트워크를 분할해서 사용할 때 서브넷 마스크가 중요한 역할을 한다.

C 클래스의 서브넷 마스크는 255.255.255.0이다. 앞에서 3자리의 255.255.255는 네트워크 주소를, 맨 마지막 1바이트는 호스트 주소를 의미한다. C 클래스의 서브넷 마스크는 255.255.255.0와 IP 주소의 AND 연산을 수행하여 네트워크 주소를 찾아내는 역할을 한다.

(image)

결론적으로 서브넷 마스크에서 1로 표시된 부분은 네트워크 주소이고, 0으로 표시된 부분은 호스트 주소를 의미한다. 이는 B 클래스의 서브넷 마스크에도, A 클래스의 서브넷 마스크에도 동일하게 적용된다.

IP 주소와 서브넷 마스크를 같이 표시할 때는, IP 주소 옆에 /와 1의 개수를 써주면 된다.

<br>

### **네트워크 분할 방법**

서브넷 마스크에서 네트워크 주소를 1로 표시한다는 특징을 이용하여 하나의 네트워크를 여러 개의 서브넷으로 나눌 수 있다.

C 클래스는 원래 이론적으로 최대 256개의 호스트를 가질 수 있는 네트워크이다. 228.255.75로 시작하는 C 클래스를 A, B 회사에게 반씩 나누어 준다고 가정했을 때, A 회사의 호스트 주소(IP 주소의 마지막 자리)는 2진수로 00000000에서 01111111까지 사용하게 된다. 즉, 호스트 주소의 맨 앞 비트가 0으로 시작하는 주소가 A 회사에 속하는 주소이다. 10진수로는 228.255.75.0에서 228.255.75.127까지의 주소이며 총 128개의 호스트 주소를 사용할 수 있다. 반면 B 회사는 2진수 10000000에서 11111111까지의 호스트 주소를 사용하게 된다. 즉, 호스트 주소의 맨 앞 비트가 1로 시작하는 주소가 B 회사에 속하는 주소이며 전체 128개의 호스트 주소를 사용함. 10진수로는 228.255.75.256까지의 주소이다.

A 회사의 컴퓨터와 B 회사의 컴퓨터는 엄연히 다른 네트워크이기 때문에, 호스트 주소의 맨 앞 비트가 실제로는 A, B 회사를 구분하는 네트워크 주소가 된다. 따라서 서브넷 마스크는 11111111 11111111 11111111 10000000이 되어야 한다. 이는 곧 4번째 바이트의 맨 처음 비트도 네트워크 주소라는 뜻이다.

2진수 10000000을 10진수로 바꾸면 128이다. 따라서 C 클래스를 2개의 서브넷으로 나눈 경우 서브넷 마스크는 255.255.255.128이 된다. 간단히 /25로도 표시한다.

<br>

### **서브넷 분할 원리**

앞의 예시를 통해 알 수 있듯이, 네트워크 주소를 나타내는 1이 24개에서 1개 더 늘어나 25개가 되는 네트워크는 2개로 분할된 것이다. 네트워크 주소를 나타내는 1의 개수가 늘어날 때마다 C 클래스는 2의 지수승으로 분할된다.

서브넷 마스크가 255.255.255.192인 네트워크는 /26이며, 앞에서부터 1의 개수가 26개임. /26은 C 클래스 네트워크를 4개로 분할한 것이다. 원래의 C 클래스 /24에서 네트워크를 나타내는 1의 숫자가 2개가 더 늘었기 때문에 네트워크는 4(=$2^2$)개로 분할된다. 4개로 분할된 네트워크에서 1개의 서브넷이 가질 수 있는 호스트의 개수는 64(=256/4)이다.

결론적으로 원래의 클래스에서 네트워크 주소를 나타내는 1의 개수가 늘어날 때마다 2의 지수승으로 네트워크가 분할됨을 알 수 있다. 이는 B, A 클래스에도 동일하게 적용된다.

단, 네트워크에서 분할을 여러 번 사용하면 홀수 개의 서브넷도 만들 수 있음에 주의한다.

(image)

<br>

## **주소 변환 관련 프로토콜**

### **주소 변환의 필요성**

IP 주소는 인터넷에서 목적지 LAN까지 도달하기 위해 필요한 주소이고, 도착한 LAN의 안쪽에서 호스트를 찾거든 IP 주소로 LAN 내부에서 통신을 하는 경우에는 해당 호스트의 MAC 주소가 필요하다.

이때 DNS와 유사하게 주소 변환 서버를 만들면 된다고 생각할 수도 있지만, 여러 치명적인 단점이 존재하기 때문에 IP 주소와 MAC 주소의 변환에 다양한 프로토콜들이 사용된다.

<br>

### **주소 변환 프로토콜 - ARP(Address Resolution Protocol)**

<u>주소 변환 서버 없이 IP 주소를 MAC 주소로 바꾸는 프로토콜</u>

주소 변환 서버가 해야 할 일을 모든 호스트가 나눠가지는 방식이다. 특정 IP의 MAC 주소를 알고 싶은 호스트는 다른 호스트들에게 질문하고, 해당 질문은 LAN 전체에 브로드캐스팅 된다. 질문을 받은 호스트 중 해당 IP를 가진 노드가 자신의 MAC 주소를 알려준다.

(image)

ARP는 단순하다. 시스템 관리자는 각 호스트에 IP 주소를 할당하고 서브넷 마스크를 결정해주면 된다.

성능을 높이기 위해 각 호스트들은 획득한 ARP 정보를 캐시에 보관한다. LAN에 속한 호스트들이 캐시를 많이 유지할수록 브로드캐스팅 되는 ARP 패킷의 숫자가 줄어든다.

IP 주소를 변경하는 경우, IP 충돌이 발생할 가능성이 있다. "(어떤 호스트)의 MAC 주소가 무엇인지"에 대한 질문을 브로드캐스팅 했을 때, 이 메시지에 응답하는 호스트가 있다면 IP 주소가 충돌한 것이다. 충돌이 발생한 경우, 해당 IP를 먼저 사용하고 있던 호스트들에게 우선권이 주어진다. 만약 충돌이 없다면, 없음을 확인한 후에 자신의 IP 주소와 MAC 주소를 전체에게 브로드캐스팅 한다. 이때 사용하는 ARP를 GARP(Gratuitous ARP)라 부른다. GARP는 응답이 필요 없는 ARP를 뜻하며 해당 정보로 캐시를 갱신해 달라는 요청이다.

<br>

### **역주소 변환 프로토콜 - RARP(Reverse ARP)와 BOOTP(Bootstrap protocol)**

MAC 주소로부터 IP 주소를 얻어야 하는 경우 RARP와 BOOTP를 사용한다.

단말기 각각은 독립적인 컴퓨터로 작동해야 하기 때문에 단말기마다 
